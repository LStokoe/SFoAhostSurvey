<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>

    <body>
        <h1>Lightning Out Test Host Page</h1>
        
        <div id="lightning-out"></div>
        <script src="https://lego--lilychina.sandbox.experience.sfcrmapps.cn/lightning/lightning.out.js"></script>
        
        <div data-lightning-out="true">
            
            <script>
                const appName = 'c:srv_HostSurvey';
                const componentName = 'c:srv_SurveyUI';
                const lightningEndpoint = 'https://lego--lilychina.sandbox.experience.sfcrmapps.cn';
                const targetElement = document.querySelector("[data-lightning-out]");

                // Function to get URL parameters
                function getUrlParameter(name) {
                    const urlParams = new URLSearchParams(window.location.search);
                    return urlParams.get(name);
                    console.log('params found', {urlParams})
                }

                const uuid = getUrlParameter('c__uuid');
                const language = getUrlParameter('c__language');
                const channelType = getUrlParameter('c__channelType');

                const componentAttributes = {
                    uuid: uuid,
                    language: language,
                    channelType: channelType
                };

                $Lightning.use(
                    appName,
                    function () {
                        $Lightning.createComponent(
                            componentName,
                            componentAttributes,
                            targetElement,
                            function (cmp) { 
                                console.log('The component was created.');
                            }
                        );
                    },
                    lightningEndpoint
                );
            </script>
        </div>
    </body>
</html>
