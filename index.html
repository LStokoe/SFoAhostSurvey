<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>

    <body>
        <h1>Lightning Out Test Host Page</h1>
        
        <div id="lightning-out"></div>
        <script src="https://lego--lilychina.sandbox.experience.sfcrmapps.cn/lightning/lightning.out.js"></script>
        
        <div data-lightning-out="true">
            
            <script>
                const appName = 'c:srv_HostSurvey';
                const componentName = 'c:srv_SurveyUI';
                const lightningEndpoint = 'https://lego--lilychina.sandbox.experience.sfcrmapps.cn';
                const targetElement = document.querySelector("[data-lightning-out]");

                //Handles URL params passed in from the web page URL
                urlParams = {};
                function getPageReference(CurrentPageReference) {
                    console.log('TIGER CurrentPageReference:', CurrentPageReference);
                    if (CurrentPageReference) {
                        this.urlParams = CurrentPageReference;
                        this.uuid = this.urlParams.state.c__uuid;
                        this.language = this.urlParams.state.c__language;
                        this.channelType = this.urlParams.state.c__channelType || 'Email';
                        console.log('TIGER UUID:', this.uuid);
                        console.log('TIGER Language:', this.language);
                        console.log('TIGER Channel Type:', this.channelType);
                    } 
                }

                const componentAttributes = {
                    uuid: uuid,
                    language: language,
                    channelType: channelType
                };

                $Lightning.use(
                    appName,
                    function () {
                        $Lightning.createComponent(
                            componentName,
                            componentAttributes,
                            targetElement,
                            function (cmp) { 
                                console.log('The component was created.');
                            }
                        );
                    },
                    lightningEndpoint
                );
            </script>
        </div>
    </body>
</html>
